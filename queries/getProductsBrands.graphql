query getProductsBrands($categoryId: [Int!], $page: Int!, $priceFilter: [BigDecimal], $brandFilter: [Int!]) {
  queryProduct(
    filterBy: {
      hierarchyCategoriesWithin: {
        ofParent: { entityPrimaryKeyInSet: $categoryId }
      }
      userFilter: [
        {
          priceBetween: $priceFilter,
          facetBrandHaving: { entityPrimaryKeyInSet: $brandFilter}
        }
      ]
      priceInPriceLists: ["basic"]
      priceInCurrency: EUR
      priceValidInNow: true
      entityLocaleEquals: en
    }
  ) {
    recordPage(number: $page, size: 50) {
      totalRecordCount
      data {
        primaryKey
        attributes {
          name
          brandCode
        }
        categories {
          referencedEntity {
            attributes {
              name
            }
          }
        }
        priceForSale {
          priceWithoutTax
          priceWithTax
          taxRate
        }
      }
      lastPageNumber
    }
    extraResults {
      facetSummary {
        parameterValues {
          count
          groupEntity {
            type
            primaryKey
            attributes {
              code
              name
            }
          }
          facetStatistics {
            requested
            impact {
              difference
              hasSense
              matchCount
            }
            facetEntity {
              primaryKey
              attributes {
                code
                name
              }
            }
          }
        }
      }
      priceHistogram {
        min
        max
        overallCount
        buckets(requestedCount: 20) {
          threshold
          occurrences
          requested
        }
      }
    }
  }
}
